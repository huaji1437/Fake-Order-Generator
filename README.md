# Fask-Order-Generator
main.py作为入口文件
# 部门假单生成器 - Department Leave Form Generator

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

> 基于正则的智能接龙解析，一键生成标准请假单，强大的容错 | 🚀 简洁实用

## 项目简介

一个智能的部门请假单生成工具，能够自动解析微信接龙或共享文档中的学生信息，快速生成格式规范的请假单文档。专为学校部门、社团组织设计，极大提升工作效率。

**核心特性：**
- 🎯 智能接龙解析，支持多种输入格式
- 📅 灵活日期识别（绝对日期、相对日期）
- 👥 自动分组输出，支持多部门同时处理
- 🛡️ 防御性编程，强大的容错能力
- 📝 标准Docx格式输出，符合学校要求

## 快速开始

### 安装依赖
```bash
pip install python-docx 
```

### 基本使用
```bash
python main.py
```

然后按照提示输入：
1. 📅 请假日期（支持多种格式）
2. 👥 接龙学生信息（直接粘贴微信接龙内容）

### 输入示例
```
# 日期输入
2025.4.27 或 today+1 或 week+1 1

# 接龙输入
1. 视频组24计应单2老王
2. 25数媒单2 张三
3. 25人工智能单 杨智睿
```

## 核心组件

### 🎮 输入器 (Input Handlers)

#### 1. 经典输入器 (`经典输入`)
- **用途**：基础学生信息解析
- **特点**：稳定可靠，适合标准格式
- **核心方法**：
  - `parse_student_data()` - 正则解析学生数据
 - **经典在**：打散了学长的脚本的结果，保持了打散前后的一致性

#### 2. 智能输入器 (`我的输入器`) 
- **用途**：高级智能解析
- **特点**：支持中文数字、灵活日期、强大容错
- **核心方法**：
  - `_get_ymd_time_by_str_save()` - 智能日期解析
  - `_match_line()` - 高级正则匹配

#### 3. 分组输入器 (`分组多输出输入器`)
- **用途**：多部门分组处理
- **特点**：按前缀自动分组，生成多个文档
- **核心方法**：
  - `_get_stu_data_from_input_and_save_to_docx()` - 分组输出逻辑

### 📄 文档生成器 (`DocumentGenerator`)
- **功能**：生成标准格式的Word请假单
- **配置驱动**：通过`config.json`自定义输出格式
- **模板化**：支持自定义文档模板

### ⚙️ 配置管理 (`ConfigReader`)
- **功能**：统一配置管理
- **支持**：专业名称映射、输出格式设置、部门信息配置

## 技术特色

### 🛡️ 防御性编程
```python
# 强大的错误处理和用户引导
try:
    year, month, day = self._get_ymd_time_by_str_save(input_time_string)
except ValueError as e:
    print(f"日期解析错误: {e} 请重新输入")
    continue
```

### 🔧 正则表达式强大
```python
# 支持中文数字、多种分隔符、容错格式
pattern = r'^(?:\d+\.\s*)?([\u4e00-\u9fa5]+组)?([\d\u4e00-\u9fa5]{2})...'
```

### 🎯 灵活日期解析
支持多种日期格式：
- 绝对日期：`2025.4.27`, `2025/4/27`, `2025 4 27`
- 相对今天：`today`, `td+1`, `today-2`
- 相对周：`week+1 1`, `w-1 7` (上周一星期七)

### 👥 智能分组
自动识别接龙中的分组前缀：
- `视频组25数媒张三` → 视频组
- `软件组25软件李四` → 软件组

## 配置说明

编辑 `config.json` 自定义行为：

```json
{
  "class_mappings": {
    "网络技术": "网络",
    "软件技术": "软件",
    "数字媒体": "数媒"
  },
  "output_settings": {
    "file_name_format": "{year}年{month}月{day}日_{cause}假单.docx"
  }
}
```

## 开发理念

> 💡 **懒**：自动化重复工作，即使编写脚本时间开销很大  
> 🛡️ **防御性编程**： 预料错误，提供清晰指引  
> 🧠 **AI辅助编码**：我说tab键比cv键磨损快
> 🔧 **抽象封装**：代码复用，易于扩展  
> 📐 **正则表达式**：文本处理的瑞士军刀  

## 致谢

<!-- 以下项目介绍引自 alice 的仓库 awesome-project： https://github.com/alice/awesome-project -->
> 
> *"Ciallo(∠・ω< )⌒☆
> 留给后来者的话：
> 
> 加油吧，学弟or学妹，学习不局限于书本，在大学想学到真本领，都得靠自己去学，兴趣是让你前行的你最大的动力。————DH 第11任 软件组负责人"*



## 许可证

MIT License - 欢迎自由使用和修改

---

*让重复的工作自动化，把时间留给更有价值的事情* ✨
